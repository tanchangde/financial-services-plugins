---
name: lbo-model-cn
description: 此技能应用于完成私募股权交易的Excel LBO（杠杆收购）模型模板、交易材料或投资委员会演示。该技能填写公式、验证计算，并确保适应任何模板结构的专业格式标准。
---

---

## 模板要求

**此技能使用LBO模型模板。首先始终检查是否有附加的模板文件。**

在开始任何LBO模型之前：
1. **如果附加/提供了模板文件**：完全使用该模板的结构 - 复制它并用用户的数据填充
2. **如果没有附加模板**：询问用户："您有特定的LBO模板希望我使用吗？如果没有，我可以使用包含资金来源与用途、运营模型、债务明细表和回报分析的的标准模板。"
3. **如果使用标准模板**：复制`examples/LBO_Model.xlsx`作为起点并用用户的假设填充

**重要**：当附加了`LBO_Model.xlsx`等文件时，您必须将其用作您的模板 - 不要从头构建。即使模板看起来复杂或功能多于需要，也请复制它并适应用户的需求。当提供模板时，永远不要决定"从头构建"。

---

## 对Claude的关键说明 - 首先阅读

### 核心原则
* **每个计算必须是Excel公式** - 永远不要在Python中计算值并将硬编码结果放入单元格。模型必须是动态的，当输入更改时会更新。
* **使用模板结构** - 遵循`examples/LBO_Model.xlsx`或用户提供的模板中的组织。不要发明自己的布局。
* **使用正确的单元格引用** - 所有公式应引用适当的单元格。永远不要输入应该来自其他单元格的数字。
* **保持符号约定一致** - 遵循模板使用的符号约定（有些对流出使用负数，有些使用正数）。全程保持一致。
* **逐部分工作** - 完成一个部分后再继续到下一部分，因为后面的部分通常依赖前面的部分。

### 公式颜色约定
* **蓝色（0000FF）**：硬编码输入 - 输入的不引用其他单元格的数字
* **黑色（000000）**：带计算的公式 - 任何使用运算符或函数的公式（=B4*B5, =SUM(), =-MAX(0,B4)）
* **紫色（800080）**：链接到**同一标签页**上的单元格 - 无计算的直接引用（=B9, =B45）
* **绿色（008000）**：链接到**不同标签页**上的单元格 - 跨表引用（=Assumptions!B5, ='Operating Model'!C10）

### 数字格式标准
* **货币**：`$#,##0;($#,##0);"-"` 或 `$#,##0.0` 取决于模板
* **百分比**：`0.0%`（一位小数）
* **倍数**：`0.0"x"`（一位小数）
* **MOIC/详细比率**：`0.00"x"`（两位小数以确保精度）
* **所有数字单元格**：右对齐

---

### 首先澄清要求

在填写任何公式之前：

* **检查模板结构** - 识别所有部分，了解时间线（哪些列是哪些期间），注意任何现有公式
* **如果模板结构、计算方法或要求不清楚，请询问用户** - 在继续之前
* **确认关键假设** - 任何关键输入、计算偏好或特定要求
* **只有理解模板后**，继续填写公式

---

## 模板分析阶段 - 首先执行此操作

在填写任何公式之前，彻底检查模板：

1. **映射结构** - 识别每个部分在哪里以及它们如何相关。记下哪些部分流入其他部分。

2. **了解时间线** - 哪些列代表哪些期间？是否有"关闭"或"预估"列？预测期从哪里开始？

3. **识别输入vs公式单元格** - 模板通常使用颜色编码、边框或阴影来指示哪些单元格需要输入vs公式。尊重这些约定。

4. **仔细阅读现有标签** - 行标签准确地告诉您期望什么计算。不要假设 - 阅读模板要求什么。

5. **检查现有公式** - 有些模板是部分填充的。不要覆盖工作的公式，除非特别要求。

6. **记下模板特定的约定** - 符号约定、小计结构、部分组织方式、是否有用于不同组件的单独标签页等。

---

## 填写公式 - 一般方法

对于每个需要公式的单元格，遵循此层次：

### 第一步：检查模板
* 单元格是否已有公式？如果有，验证它正确然后继续。
* 是否有注释或笔记指示预期计算？
* 行/列标签使计算显而易见吗？
* 相邻单元格是否显示您应该遵循的模式？

### 第二步：检查用户的说明
* 用户是否指定了特定的计算方法？
* 是否有影响此公式的 stated assumptions？
* 是否提到了任何特殊要求？

### 第三步：应用标准实践
* 如果模板和用户都没有指定，使用标准LBO建模约定
* 记录您做的任何假设
* 如果真的不确定，询问用户

---

## 常见问题区域

以下计算模式在LBO模型中经常引起问题。遇到这些时要特别注意：

### 平衡部分
* 当两部分必须相等时（例如来源 = 用途），通常一项是"plug"（平衡数字）
* 识别哪一项是plug并计算为差额

### 税费计算
* 税费公式应仅引用相关收入行和税率
* 不应引用无关部分（例如债务明细表）
* 考虑亏损是创建税费盾还是简单忽略

### 利息和循环引用
* 利息计算如果引用受现金流影响的余额可能会产生循环性
* 使用**期初余额**（而非平均或期末）打破循环
* 模式：利息 → 现金流 → 偿还 → 期末余额（如果利息使用期末余额，这会循环回来）

### 债务偿还/现金扫除
* 当存在多个债务 tranche 时，通常有优先级顺序
* 现金扫除应尊重优先级瀑布
* 余额不能为负 - 适当使用MAX或MIN函数

### 回报计算（IRR/MOIC）
* 现金流必须有正确的符号：投资 = 负数，收益 = 正数
* 如果使用XIRR，需要相应的日期
* 如果使用IRR，现金流应在连续期间
* MOIC = 总收益 / 总投资

### 敏感性表
* Excel的DATA TABLE功能可能与openpyxl不工作
* 可能需要明确引用行/列标题的公式
* 每个单元格应显示**不同值** - 如果全部相同，公式没有正确变化
* 使用混合引用（例如A5表示行输入，B$4表示列输入）

---

## 验证检查清单 - 完成后运行

### 运行公式验证
```bash
python /mnt/skills/public/xlsx/recalc.py model.xlsx
```
必须返回成功，零错误。

### 部分平衡
- [ ] 必须平衡的任何部分（来源/用途、资产/负债）完全平衡
- [ ] Plug项目正确计算为差额
- [ ] 跨部分应该匹配的金额一致

### 收入/运营预测
- [ ] 收入/顶线从驱动因素或增长率正确构建
- [ ] 所有成本和费用项目适当计算
- [ ] 小计和总计正确求和
- [ ] 利润率和比率合理
- [ ] 链接到假设正确

### 资产负债表（如适用）
- [ ] 资产 = 负债 + 权益（必须平衡）
- [ ] 所有项目链接到适当的明细表或滚动
- [ ] 期初余额 = 前期期末余额
- [ ] 包含检查行并显示零

### 现金流量表（如适用）
- [ ] 以正确的收入数字开始
- [ ] 非现金项目适当添加/扣除
- [ ] 营运资本变化具有正确的符号
- [ ] 期末现金 = 期初现金 + 净现金流
- [ ] 现金流在各报表之间一致

### 支持明细表
- [ ] 滚动明细表平衡（期初 + 变化 = 期末）
- [ ] 明细表正确链接到主报表
- [ ] 计算项目使用适当的驱动因素
- [ ] 所有期间一致计算

### 债务/融资明细表（如适用）
- [ ] 期初余额与来源或前期挂钩
- [ ] 利息在适当余额上计算（通常期初）
- [ ] 偿还尊重现金可用性和优先级
- [ ] 期末余额不能为负
- [ ] 总计正确求和各tranche

### 回报/输出分析
- [ ] 退出/终值正确计算
- [ ] 包含所有相关调整
- [ ] 现金流符号正确（投资为负，收益为正）
- [ ] IRR/MOIC公式引用完整范围
- [ ] 结果对情景合理

### 敏感性表（如适用）
- [ ] 行和列标题包含适当的输入值
- [ ] 每个数据单元格包含公式（不是硬编码）
- [ ] 每个数据单元格显示**不同值**
- [ ] 值按预期方向移动
- [ ] 基准情况出现在标题匹配基准假设的地方

### 格式
- [ ] 硬编码输入为蓝色（0000FF）
- [ ] 计算公式为黑色（000000）
- [ ] 同一标签页链接为紫色（800080）
- [ ] 跨标签页链接为绿色（008000）
- [ ] 所有数字右对齐
- [ ] 整个应用适当的数字格式
- [ ] 没有单元格显示错误值（#REF!、#DIV/0!、#VALUE!、#NAME?）

### 合理性逻辑检查
- [ ] 数字数量级合理
- [ ] 趋势合理（增长、下降、稳定如预期）
- [ ] 没有明显错误的值（应该为正的地方为负、不可能的百分比等）
- [ ] 关键输出在分析类型合理范围内

---

## 要避免的常见错误

| 错误 | 问题 | 如何修复 |
|------|------|----------|
| 硬编码计算值 | 输入更改时模型不更新 | 始终使用引用源单元格的公式 |
| 复制后单元格引用错误 | 公式指向错误单元格 | 验证所有链接，使用适当的$锚定 |
| 循环引用错误 | 模型无法计算 | 对利息类计算使用期初余额，打破循环 |
| 部分不平衡 | 应该匹配的总数不匹配 | 确保一项是plug（计算为差额） |
| 不可能为负的余额 | 支付/使用超过可用 | 适当使用MAX(0,...)或MIN函数 |
| IRR/回报错误 | 符号错误或不完整范围 | 检查现金流符号并确保公式覆盖所有期间 |
| 敏感性表显示相同值 | 公式不随输入变化 | 检查单元格引用 - 需要混合引用（$A5, B$4） |
| 滚动不衔接 | 期初≠前期期末 | 验证期间之间的链接 |
| 符号约定不一致 | 加法变成减法或反之 | 整个遵循模板的约定 |

---

## 与用户合作

* **如果模板结构不清楚**，在继续之前询问
* **如果用户要求与模板冲突**，确认他们的偏好
* **完成每个主要部分后**，展示工作或运行验证
* **如果在验证过程中发现错误**，在继续到下一部分之前修复
* **展示您的工作** - 在有帮助时解释关键公式或假设

---

**此技能通过填写正确公式、适当格式和经验证的计算来产生投资银行级LBO模型。该技能适应任何模板结构，同时确保财务准确性和专业演示标准。**