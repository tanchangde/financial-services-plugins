---
name: dcf-model-cn
description: 创建真正的DCF（折现现金流）模型用于股权估值。从SEC申报文件和分析报告检索财务数据，构建具有适当WACC计算的全面现金流预测，进行敏感性分析，并输出带有执行摘要的专业Excel模型。当用户需要使用DCF方法论对公司进行估值、要求内在价值分析或请求详细财务建模与增长预测和终值计算时使用。
---

# DCF模型构建器

## 概述

此技能创建遵循投资银行标准的机构级DCF模型用于股权估值。每次分析都会生成一个详细的Excel模型（DCF工作表底部包含敏感性分析）。

## 工具

- 默认使用用户提供的所有信息和可用的MCP服务器进行数据 sourcing。

## 关键约束 - 请先阅读以下内容

这些约束适用于所有DCF模型构建。在开始之前复习：

**敏感性表：**
- 使用完整DCF重新计算公式填充所有75个单元格（3个表 × 25个单元格）
- 使用openpyxl循环以编程方式写入公式
- 无占位符文本、无线性近似、无需手动步骤
- 每个单元格必须为该假设组合重新计算完整DCF

**单元格注释：**
- 在创建每个硬编码值时添加单元格注释
- 格式："来源：[系统/文档]，[日期]，[参考]，如有URL则[URL]"
- 每个蓝色输入单元格在进入下一部分之前必须添加注释
- 不要推迟到结束或写"待办：添加来源"

**模型布局规划：**
- 在写任何公式之前定义所有部分行位置
- 首先写所有标题和标签
- 其次写所有部分分隔符和空白行
- 然后使用锁定的行位置写公式
- 创建后立即测试公式

**公式重新计算：**
- 交付前运行`python recalc.py model.xlsx 30`
- 修复所有错误直到状态为"成功"
- 需要零公式错误（#REF!、#DIV/0!、#VALUE!等）

**情景块：**
- 为熊市/基准/牛市情况创建单独的块
- 在每个块内显示假设横跨预测年份
- 使用IF公式：`=IF($B$6=1,[熊市情况对应的单元格],IF($B$6=2,[基准情况对应的单元格],[牛市情况对应的单元格]))`
- 验证公式引用正确的情景块单元格

## DCF流程工作流

### 第一步：数据检索和验证

从MCP服务器、用户提供的数据和网络获取数据。

**数据来源优先级：**
1. **MCP服务器**（如已配置）- 来自Daloopa等提供商的Structured财务数据
2. **用户提供的数据** - 来自他们研究的历史财务数据
3. **网络搜索/获取** - 需要时的当前价格、贝塔、债务和现金

**验证检查清单：**
- 验证净债务vs净现金（对估值至关重要）
- 确认稀释股份数（检查最近的回购/发行）
- 验证历史利润率与商业模式一致
- 交叉检查收入增长率与行业基准
- 验证税率合理（通常21-28%）

### 第二步：历史分析（3-5年）

分析和记录：
- **收入增长趋势**：计算CAGR，识别驱动因素
- **利润率进程**：跟踪毛利率、EBIT利润率、自由现金流利润率
- **资本强度**：折旧摊销和资本支出占收入百分比
- **营运资本效率**：净营运资本变化占收入增长百分比
- **回报指标**：ROIC、ROE趋势

创建摘要表显示：
```
历史指标（LTM）：
收入：X百万美元
收入增长：X% CAGR
毛利率：X%
EBIT利润率：X%
折旧摊销占收入：X%
资本支出占收入：X%
自由现金流利润率：X%
```

### 第三步：构建收入预测

**方法论：**
1. 从最新实际收入开始（LTM或最近财年）
2. 为每个预测年份应用增长率
3. 同时显示美元金额和计算的增长率%

**增长率框架：**
- 第1-2年：更高增长反映近期可见性
- 第3-4年：逐渐缓和至行业平均
- 第5年+：接近终值增长率

**公式结构：**
- 收入(第N年) = 收入(第N-1) × (1 + 增长率)
- 增长率%(第N年) = 收入(第N年) / 收入(第N-1) - 1

**三情景方法：**
```
熊市情况：保守增长（例如8-12%）
基准情况：最可能情况（例如12-16%）
牛市情况：乐观增长（例如16-20%）
```

### 第四步：运营费用建模

**固定/可变成本分析：**

运营费用应模拟现实的运营杠杆：
- **销售与营销**：通常占收入的15-40%，取决于商业模式
- **研发**：通常科技公司占10-30%
- **一般及行政**：通常占收入的8-15%，显示随公司规模扩大的杠杆

**关键原则：**
- 所有百分比基于收入，而非毛利润
- 模拟运营杠杆：百分比应随收入规模下降
- 保持销售及营销、研发、一般及行政的单独行项目
- 计算EBIT = 毛利润 - 总运营费用

**利润率扩张框架：**
```
当前状态 → 目标状态（第5年）
毛利率：X% → Y%（基于规模、效率证明）
EBIT利润率：X% → Y%（收入增长 + 运营费用杠杆的结果）
```

### 第五步：自由现金流计算

**按正确顺序构建自由现金流：**

```
EBIT
(-) 税费（EBIT × 税率）
= NOPAT（税后净营业利润）
(+) 折旧摊销（非现金费用，占收入%）
(-) 资本支出（占收入%，通常4-8%）
(-) Δ 净营运资本（营运资本变化）
= 无杠杆自由现金流
```

**营运资本建模：**
- 计算为收入变化的百分比（增量收入）
- 典型范围：-2%至+2%收入变化
- 负数 = 现金来源（营运资本释放）
- 正数 = 现金使用（营运资本构建）

**维护vs增长资本支出：**
- 维护资本支出：维持当前运营（约2-3%收入）
- 增长资本支出：支持扩张（额外2-5%收入）
- 总资本支出应与公司增长战略一致

### 第六步：资本成本（WACC）研究

**股权成本CAPM方法论：**

```
股权成本 = 无风险利率 + 贝塔 × 股权风险溢价

其中：
- 无风险利率 = 当前10年期国债收益率
- 贝塔 = 5年月度股票贝塔vs市场指数
- 股权风险溢价 = 5.0-6.0%（市场标准）
```

**债务成本计算：**

```
税后债务成本 = 税前债务成本 × (1 - 税率)

从以下确定税前债务成本：
- 信用评级（如有）
- 公司债券的当前收益率
- 财务中的利息费用 / 总债务
```

**资本结构权重：**

```
股权市场价值 = 当前股价 × 流通股份
净债务 = 总债务 - 现金及等价物
企业价值 = 市值 + 净债务

股权权重 = 市值 / 企业价值
债务权重 = 净债务 / 企业价值

WACC = (股权成本 × 股权权重) + (税后债务成本 × 债务权重)
```

**特殊情况：**
- **净现金状况**：如果现金 > 债务，净债务为负
  - 债务权重可能为负
  - WACC计算相应调整
- **无债务**：WACC = 股权成本

**典型WACC范围：**
- 大型股、稳定：7-9%
- 成长型公司：9-12%
- 高增长/风险：12-15%

### 第七步：折现率应用（5-10年预测）

**年中惯例：**
- 假设现金流发生在年中
- 折现期：0.5、1.5、2.5、3.5、4.5等
- 折现因子 = 1 / (1 + WACC)^期间

**现值计算：**
```
对于每个预测年份：
自由现金流现值 = 无杠杆自由现金流 × 折现因子

示例（第1年）：
自由现金流 = 1,000美元
WACC = 10%
期间 = 0.5
折现因子 = 1 / (1.10)^0.5 = 0.9535
现值 = 1,000 × 0.9535 = 954美元
```

**预测期选择：**
- **5年**：大多数分析的标准
- **7-10年**：具有更长跑道的高增长公司
- **3年**：成熟、稳定的企业

### 第八步：终值计算

**永续增长法（首选）：**

```
终值自由现金流 = 终年自由现金流 × (1 + 终值增长率)
终值 = 终值自由现金流 / (WACC - 终值增长率)

关键约束：终值增长率 < WACC（否则无限价值）
```

**终值增长率选择：**
- 保守：2.0-2.5%（GDP增长率）
- 中等：2.5-3.5%
- 激进：3.5-5.0%（仅适用于市场领导者）

**不要超过**：无风险利率或长期GDP增长

**退出倍数法（替代）：**
```
终值 = 终年EBITDA × 退出倍数

其中退出倍数来自：
- 行业可比交易倍数
- 先例交易倍数
- 典型范围：8-15倍EBITDA
```

**终值现值：**
```
终值现值 = 终值 / (1 + WACC)^终期

其中终期考虑时间：
5年模型使用年中惯例：期间 = 4.5
```

**终值合理性检查：**
- 应占企业价值的50-70%
- 如果>75%，模型可能过度依赖终值假设
- 如果<40%，检查终值假设是否过于保守

### 第九步：企业价值到股权价值桥接

**估值摘要结构：**

```
(+) 预测自由现金流现值合计 = X百万美元
(+) 终值现值 = Y百万美元
= 企业价值 = Z百万美元

(-) 净债务[或如果为负则+净现金] = A百万美元
= 股权价值 = B百万美元

÷ 稀释流通股份 = C百万股
= 每股隐含价格 = XX.XX美元

当前股价 = YY.YY美元
隐含回报 = (隐含价格 / 当前价格) - 1 = XX%
```

**关键调整：**
- **净债务 = 总债务 - 现金及等价物**
  - 如果为正：从企业价值中减去（降低股权价值）
  - 如果为负（净现金）：加到企业价值（增加股权价值）
- **使用稀释股份**：包括期权、限制性股票单位、可转债
- **其他调整**（如适用）：
  - 少数股东权益
  - 养老金负债
  - 经营租赁义务

**估值输出格式：**
```csv
估值组成部分,金额（百万美元）
预测自由现金流现值,X.X
终值现值,Y.Y
企业价值,Z.Z
(-) 净债务,A.A
股权价值,B.B
,,
流通股份（百万）,C.C
每股隐含价格,$XX.XX
当前股价,$YY.YY
隐含上涨/下跌,+XX%
```

### 第十步：敏感性分析

在DCF工作表底部构建**三个敏感性表**，显示估值如何随不同假设变化：

1. **WACC vs 终值增长率** - 显示企业价值对折现率和永续增长的敏感性
2. **收入增长率 vs EBIT利润率** - 显示顶线增长和运营杠杆的影响
3. **贝塔 vs 无风险利率** - 显示股权成本组成部分的敏感性

**实现**：这些是简单的2D网格（不是Excel的"数据表"功能），每个单元格都有公式。每个单元格必须包含该特定假设组合的完整DCF重新计算。请参阅关键约束部分，了解使用openpyxl以编程方式填充所有75个单元格的详细要求。

---

正确模式

本节包含构建DCF模型时应遵循的所有正确模式。

### 情景块选择模式 - 遵循此方法

**假设按每个情景的单独块组织：**

**关键结构 - 每个部分标题三行：**

```csv
熊市情况假设（部分标题，合并单元格）
假设,第1年,第2年,第3年,第4年,第5年
收入增长率（%）,12%,10%,9%,8%,7%
EBIT利润率（%）,45%,44%,43%,42%,41%

基准情况假设（部分标题，合并单元格）
假设,第1年,第2年,第3年,第4年,第5年
收入增长率（%）,16%,14%,12%,10%,9%
EBIT利润率（%）,48%,49%,50%,51%,52%

牛市情况假设（部分标题，合并单元格）
假设,第1年,第2年,第3年,第4年,第5年
收入增长率（%）,20%,18%,15%,13%,11%
EBIT利润率（%）,50%,51%,52%,53%,54%
```

**每个情景块必须有一行列标题**显示预测年份（FY2025E、FY6E等），紧接在部分标题下方。没有这个，用户无法判断哪个假设值对应哪一年。

**如何引用假设 - 创建合并列：**
1. 情景选择器单元格（例如B6）包含1=熊市、2=基准或3=牛市
2. 创建具有INDEX或OFFSET公式的合并列以从正确情景块拉取
3. 预测公式引用合并列（干净的单元格引用）
4. 每个情景块包含跨预测年份的完整DCF假设集

**推荐的合并列模式（使用INDEX）：**
`=INDEX(B10:D10, 1, $B$6)`

**不要这样 - 分散的IF语句：**
`=IF($B$6=1,[熊市块单元格],IF($B$6=2,[基准块单元格],[牛市块单元格]))`

合并列方法集中逻辑，使模型更易于审计。

### 正确的收入预测模式

**创建用于第1年增长的合并列，然后预测引用它：**

**第1步 - FY1增长合并列：**
`=INDEX([熊市FY1增长]:[牛市FY1增长], 1, $B$6)`

**第2步 - 收入预测引用合并列：**
`收入第1年: =D29*(1+$E$10)`

其中：
- D29 = 上年收入
- $E$10 = FY1增长的合并列单元格（包含INDEX公式）
- $B$6 = 情景选择器（1=熊市、2=基准、3=牛市）

这种方法比在每个预测公式中嵌入IF语句更干净，并且使得审计使用哪些情景假设更加容易。

### 正确的自由现金流公式模式

**使用带有INDEX公式的合并列，然后在FCF计算中引用它们：**

**合并列方法：**
```csv
项目,公式,引用
折旧摊销,=E29*$E$21,$E$21 = 折旧摊销%合并列
资本支出,=E29*$E$22,$E$22 = 资本支出%合并列
Δ 净营运资本,=(E29-D29)*$E$23,$E$23 = 净营运资本%合并列
无杠杆自由现金流,=E57+E58-E60-E62,E57=NOPAT E58=折旧摊销 E60=资本支出 E62=Δ净营运资本
```

**每个合并列单元格都包含INDEX公式**，根据情景选择器从适当的情景块拉取。这使预测公式保持干净和可审计。

在写公式之前，确认情景块行位置并设置合并列。

### 正确的单元格注释格式

**每个硬编码值都需要此格式：**

"来源：[系统/文档]，[日期]，[参考]，如有URL则[URL]"

**示例：**
```csv
项目,来源注释
股价,来源：市场数据脚本2025-10-12收盘价
流通股份,来源：10-K FY2024第45页附注12
历史收入,来源：10-K FY2024第32页合并报表
贝塔,来源：市场数据脚本2025-10-12 5年月度贝塔
共识估计,来源：管理层2024年第三季度财报电话会议指引
```

### 正确的假设表结构

**关键：每个情景块需要三个结构元素：**

1. **部分标题行**（合并单元格）：例如"熊市情况假设"
2. **显示年份的列标题行** - 这是必需的，不要跳过
3. **带假设值的数据行**

**结构：**
```csv
熊市情况假设（部分标题 - 跨列A:G合并）
假设,第1年,第2年,第3年,第4年,第5年
收入增长率（%）,X%,X%,X%,X%,X%
EBIT利润率（%）,X%,X%,X%,X%,X%
终值增长率,X%,,,,
WACC,X%,,,,

基准情况假设（部分标题 - 跨列A:G合并）
假设,第1年,第2年,第3年,第4年,第5年
收入增长率（%）,X%,X%,X%,X%,X%
EBIT利润率（%）,X%,X%,X%,X%,X%
终值增长率,X%,,,,
WACC,X%,,,,

牛市情况假设（部分标题 - 跨列A:G合并）
假设,第1年,第2年,第3年,第4年,第5年
收入增长率（%）,X%,X%,X%,X%,X%
EBIT利润率（%）,X%,X%,X%,X%,X%
终值增长率,X%,,,,
WACC,X%,,,,
```

**没有显示预测年份（FY2025E、FY6E等）的列标题行，用户无法判断哪个假设值对应哪一年。这一行是强制性的。**

**然后创建一个合并列**（通常在右侧的下一列），使用INDEX公式根据情景选择器从选定的情景块拉取。这是您的预测公式引用的合并列。

### 正确的行规划过程

**1. 首先写所有标题和标签：**
```csv
行,内容
1,[公司名称]DCF模型
2,股票代码 | 日期 | 财年结束

4,情景选择器

7,关键假设
26,假设标题
27-31,增长假设
...,...
```

**2. 写所有部分分隔符和空白行**

**3. 然后使用锁定的行位置写公式**

**4. 创建后立即测试公式**

**把它想象成建造：**
- 好：先浇筑地基，然后建墙（结构稳定）
- 坏：先建墙，然后浇筑地基（墙会倒塌）

**Excel版本：**
- 好：添加标题，然后写公式（公式稳定）
- 坏：先写公式，然后添加标题（公式会损坏）

### 正确的敏感性表实现

**重要**：这些不是Excel的"数据表"功能。这些是我们使用openpyxl编写常规公式的简单网格。是的，这意味着总共约75个公式（3个表×25个单元格），但这很简单且是必需的。

**使用公式的编程填充：**

每个敏感性表必须完全填充公式，为每个假设组合重新计算隐含股价。**不要使用Excel的数据表功能**（它需要手动干预，无法通过openpyxl自动化）。

**实现方法 - 具体示例：**

**表结构（5x5网格）：**
```csv
WACC vs 终值增长率,2.0%,2.5%,3.0%,3.5%,4.0%
8.0%,[B88公式],[C88公式],[D88公式],[E88公式],[F88公式]
9.0%,[B89公式],[C89公式],[D89公式],[E89公式],[F89公式]
...,...,...,...,...,...
```

**公式模式 - B88单元格（WACC=8.0%，终值增长率=2.0%）：**

B88中的公式应使用以下内容重新计算隐含价格：
- 来自行标题的WACC：$A88（8.0%）
- 来自列标题的终值增长率：B$87（2.0%）

**推荐方法：** 引用主DCF计算但替换这些值。

**示例公式结构：**
`=<使用$A88作为折现率的预测自由现金流现值合计> + <使用B$87作为增长率和$A88作为WACC的终值> - 净债务> / 股份`

**关键 - 为5x5网格中的每个单元格写一个公式（每个表25个单元格，总共75个单元格）。** 使用openpyxl在循环中以编程方式写入这些公式。不要跳过此步骤或留占位符文本。

**Python实现模式：**
```python
# 填充敏感性表的伪代码
for row_idx, wacc_value in enumerate(wacc_range):
    for col_idx, term_growth_value in enumerate(term_growth_range):
        # 构建使用wacc_value和term_growth_value的公式
        formula = f"=<使用{wacc_value}和{term_growth_value}重新计算DCF>"
        ws.cell(row=start_row+row_idx, column=start_col+col_idx).value = formula
```

**敏感性表必须在打开模型时立即工作，无需用户手动步骤。**

---

常见错误

本节包含构建DCF模型时应避免的所有错误模式。

### 错误：简化的敏感性表近似或占位符文本

**不要使用线性近似：**

```
// 错误 - 线性近似
B97: =B88*(1+(0.096-0.116))    // 假设线性关系

// 错误 - 除法捷径
B105: =B88/(1+(E48-0.07))      // 不会重新计算完整DCF
```

**不要留占位符文本：**
```
// 错误 - 占位符注释
"注意：使用Excel数据表功能（数据 → 假设分析 → 数据表）填充敏感性表。"

// 错误 - 空单元格
[因为"这很复杂"而留空单元格]
```

**不要混淆术语：**
- ❌ "敏感性表需要Excel的数据表功能"（不 - 那是我们不能使用的特定Excel工具）
- ✅ "敏感性表是每个单元格都有公式的简单网格"（是的 - 这是我们构建的）

**为什么这些捷径是错误的：**
- 线性近似公式实际上不会重新计算DCF - 它们只是应用简单的数学调整
- 关系不是线性的，所以结果将不准确
- 占位符文本需要手动用户干预
- 交付时模型不能立即使用
- 不专业或不适合客户
- 空单元格 = 不完整的交付品

**要拒绝的常见理由：**
"写75+个公式感觉复杂，所以我会留注释让用户手动完成。"

**现实：** 使用Python和openpyxl循环编写75个公式很简单。每个公式遵循相同的模式 - 只需替换行/列值。这是交付品的必需部分。

**相反：** 用重新计算该特定假设组合的完整DCF的公式填充每个敏感性单元格。

### 错误：缺少单元格注释

**不要这样做：**
- 创建所有硬编码输入时不加注释
- 认为"我稍后会添加"
- 写"待办：添加来源"
- 蓝色输入没有文档

**为什么它是错的：**
- 无法验证数据来自哪里
- 违反xlsx技能要求
- 不能审计
- 稍后修复浪费时间

**相反：** 在创建每个硬编码值时添加单元格注释。

### 错误：公式行引用偏移

**症状：**
FCF部分引用错误的假设行：
`折旧摊销:  =E29*$E$34    // 应该是$E$21，但引用了错误的行`
`资本支出: =E29*$E$41   // 应该是$E$22，但行偏移了`

**为什么会发生：**
1. 首先写公式
2. 然后插入标题
3. 所有行引用偏移
4. 现在公式指向错误的单元格 → #REF!错误

**相反：** 首先锁定行布局，然后写公式。

### 错误：每个情景的假设占一行

**不要这样构建假设：**
```csv
假设,熊市,基准,牛市
收入增长率FY1,10%,13%,16%
收入增长率FY2,9%,12%,15%
```
这种垂直布局使得难以看到每个情景内跨年份的进展。

**为什么它是错的：**
- 使得难以看到每个情景内假设跨年份的演变
- 难以跨整个预测期比较情景假设
- 对审查情景逻辑不太直观

**相反：**
- 为每个情景（熊市、基准、牛市）创建单独的块
- 在每个块内，假设横跨预测年份显示
- 这使得每个情景的假设更容易作为一个连贯集合来审查

### 错误：无边框

**不要交付无边框的模型：**
- 无部分分隔
- 所有单元格混在一起
- 难以阅读和不专业

**为什么它是错的：**
- 不适合客户
- 难以导航
- 看起来业余

**相反：** 为所有主要部分添加专业边框。

### 错误：错误的字体颜色或无字体颜色区分

**不要这样做：**
- 所有文本都是黑色
- 只使用填充颜色（无字体颜色变化）
- 混淆哪些单元格是蓝色vs黑色

**为什么它是错的：**
- 无法区分输入和公式
- 审计变得不可能
- 违反xlsx技能要求

**相反：** 所有硬编码输入使用蓝色文本，所有公式使用黑色文本，绿色用于工作表链接。

### 错误：运营费用基于毛利润

**不要这样做：**
`销售及管理费用: =E33*0.15    // E33 = 毛利润（错误）`

**为什么它是错的：**
- 运营费用随收入而非毛利润扩展
- 产生不现实的利润率进程
- 不是企业实际运营方式

**相反：**
`销售及管理费用: =E29*0.15    // E29 = 收入（正确）`

### 前5个错误总结

1. **公式行引用偏移** → 在写公式之前定义所有行位置
2. **缺少单元格注释** → 在创建单元格时添加注释，而不是结束时
3. **简化的敏感性表** → 用完整DCF重新计算公式填充所有单元格，而不是近似
4. **情景块引用错误** → 确保IF公式从正确的熊市/基准/牛市块拉取
5. **无边框** → 添加专业部分边框以适合客户的外观

此外，注意这些错误：

### WACC计算错误
- 在资本结构中混合账面价值和市场价值
- 错误使用股权贝塔而非资产/无杠杆贝塔
- 错误的税率应用于债务成本
- 错误的无风险利率（必须使用当前10年国债）
- 未能调整净债务vs净现金状况

### 增长假设缺陷
- 终值增长率 > WACC（创建无限价值）
- 预测增长率与历史表现不一致
- 忽略行业增长约束
- 收入增长与单位经济不一致
- 无运营理由的利润率扩张

### 终值错误
- 使用错误的增长方法（永续vs退出倍数）
- 终值 > 企业价值的80%（提示过度依赖）
- 与稳态假设不一致的终值利润率
- 终值错误的折现期

### 现金流预测错误
- 运营费用基于毛利润而非收入
- 折旧摊销/资本支出百分比与商业模式不一致
- 营运资本变化计算不正确
- 年份间税率不一致
- NOPAT计算错误

**这些错误是最常见的。在开始任何DCF构建之前重新阅读本节。**

## Excel文件创建

**此技能使用`xlsx`技能进行所有电子表格操作。** xlsx技能提供：
- 标准化的公式构建和格式
- 自动公式审计
- 专业输出格式

### xlsx技能集成

DCF模型构建使用xlsx技能来：
1. 创建和格式化Excel工作簿
2. 构建所有DCF公式
3. 应用专业格式
4. 添加敏感性表
5. 运行公式验证

### 使用openpyxl

对于敏感性表，使用openpyxl直接操作Excel文件：

```python
import openpyxl

# 打开模型
wb = openpyxl.load_workbook('model.xlsx')
ws = wb['DCF']

# 填充敏感性表
for row_idx, wacc in enumerate(wacc_values):
    for col_idx, term_growth in enumerate(term_growth_values):
        cell = ws.cell(row=start_row + row_idx, column=start_col + col_idx)
        # 构建引用当前wacc和term_growth的公式
        cell.value = f"=你的DCF公式使用${wacc}和{term_growth}"

wb.save('model.xlsx')
```

## 交付要求

所有DCF模型必须：
1. 零公式错误（#REF!、#DIV/0!、#VALUE!等）
2. 所有假设有来源注释
3. 完整的敏感性分析（75个公式）
4. 熊市/基准/牛市情景
5. 清晰的估值桥接
6. 专业格式

## 数据验证

构建模型后，运行验证：
```bash
python recalc.py model.xlsx 30
```

此脚本将：
- 检查所有公式错误
- 验证三表链接
- 确认资产负债表平衡
- 测试敏感性表

只有在所有检查通过后才交付。

---

**此技能创建投资银行级DCF模型，具有正确的公式、适当的格式和经过验证的计算。该技能适应任何模板结构，同时确保财务准确性和专业演示标准。**