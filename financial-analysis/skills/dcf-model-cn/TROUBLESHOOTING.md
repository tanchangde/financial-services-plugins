# DCF模型故障排除指南

**适用场景：** 如果recalc.py显示错误，或估值结果似乎不合理，或情景选择器不能正常工作。

## 模型返回错误值

### #REF!错误
- 通常由在插入标题后引用错误行的公式引起
- 解决方案：使用正确的行引用重建，或按照布局规划从头开始
- 预防：在写公式之前定义所有行位置

### #DIV/0!错误
- 除以零或空单元格
- 解决方案：添加IF语句处理零：`=IF([除数]=0,0,[分子]/[除数])`

### #VALUE!错误
- 计算中的错误数据类型（文本而非数字）
- 解决方案：验证所有输入格式化为数字

## 估值看起来不合理

### 隐含价格太高
- 检查终值是否占企业价值的80%以上
- 验证终值增长率 < WACC
- 审查增长率假设是否现实
- 考虑利润率是否过于乐观

### 隐含价格太低
- 验证净债务vs净现金是否正确
- 检查WACC是否过高
- 审查预测是否过于保守
- 考虑终值增长率是否过低

## 情景选择器不工作

### 切换情景时合并列不更新
- 验证情景选择器单元格包含1、2或3
- 检查INDEX/OFFSET公式引用正确的行范围和选择器单元格
- 确保对选择器使用绝对引用（$B$6）
- 通过手动更改选择器单元格并验证预测值更新来测试