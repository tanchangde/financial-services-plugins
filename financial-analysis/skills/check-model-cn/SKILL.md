---
name: check-model-cn
description: 调试和审计财务模型中的错误——循环引用、公式错误、硬编码覆盖、资产负债表不平衡、现金流量不匹配和逻辑漏洞。当模型不衔接、产生意外结果、或在发送给客户或IC之前使用。触发词包括"调试模型"、"模型检查"、"审计模型"、"模型无法平衡"、"模型有点问题"、"检查我的模型"、"QA模型"或"模型审查"。
---

# 模型检查器

## 工作流

### 第一步：导入模型

- 接受用户的Excel模型（.xlsx或.xlsm）
- 识别模型类型：DCF、LBO、并购、三表、可比公司、回报率或自定义
- 映射结构：存在哪些标签页、如何链接、输入vs输出在哪里

### 第二步：结构检查

**标签页和布局审查：**
- 输入是否与计算明确分开？
- 是否有统一的颜色编码约定？（蓝色=输入，黑色=公式，绿色=链接）
- 是否有隐藏的标签页或行可能包含覆盖？
- 模型流程是否合理？（假设 → IS → BS → CF → 估值）

**公式一致性：**
- 检查公式内的硬编码数字（部分硬编码）
- 检查跨行/列范围的公式是否一致（应该是跨期拖动的相同公式）
- 识别任何#REF!、#VALUE!、#N/A、#DIV/0!错误
- 标记格式为公式但包含硬编码值的单元格

### 第三步：完整性检查

**资产负债表：**
- 总资产 = 总负债 + 权益（每个期间）
- 如果不平衡，量化差距并追踪哪里出问题
- 检查留存收益是否正确滚动：前期RE + 净利润 - 股息 = 本期RE
- 验证商誉和无形资产是否来自并购假设（如为并购模型）

**现金流量表：**
- CF期末现金 = BS现金（每个期间）
- 经营CF + 投资CF + 融资CF = 现金变化
- CF上的折旧摊销与IS上的匹配
- CF上的资本支出与BS上的PP&E滚动匹配
- CF上的营运资本变化与BS变动匹配（应收账款、应付账款、存货）

**损益表：**
- 收入构建与分部/产品明细挂钩
- 销售成本和毛利率与假设一致
- 税费 = 税前利润 × 税率（检查递延税调整）
- 股份数与稀释计划挂钩（期权、可转债、回购）

**循环引用：**
- 检查循环引用（利息费用 → 债务余额 → 现金 → 利息）
- 如果是有意的（常见于LBO/三表模型），验证迭代开关是否有效
- 如果是无意的，追踪循环并建议如何打破

### 第四步：逻辑检查

**合理性：**
- 增长率有意义吗？（没有解释的100%+收入增长 = 红旗）
- 利润率在行业规范内吗？标记异常值
- 终值是否主导DCF？（TV占EV >75%是黄旗）
- 预测是否 Unrealistically hockey-sticking？
- EBITDA增长到第10年是否复合到荒谬的数字？

**敏感性和边缘情况：**
- 0%增长或负增长会发生什么？
- 模型在负EBITDA下是否崩溃？
- 杠杆率是否变为负数或超过现实范围？
- 是否有任何除零风险？

**跨表一致性：**
- 链接单元格是否与其来源实际匹配？（复制粘贴错误很常见）
- 所有标签页上的日期标题是否一致？
- 单位是否匹配（千 vs 百万 vs 实际）？

### 第五步：按模型类型的常见错误

**DCF：**
- 折现率应用于错误的期间（年中vs年末约定）
- 终值未正确折回
- WACC使用账面价值而非市场价值
- FCF包含利息费用（应为无杠杆）
- 税盾重复计算

**LBO：**
- 债务偿还与现金扫除机制不匹配
- PIK利息未累积到债务余额
- 管理层滚动未反映在回报中
- 退出倍数应用于错误的EBITDA（LTM vs NTM）
- 费用和支出未从第1天权益中扣除

**并购模型：**
- 稀释/增值使用错误的股份数（交易前vs交易后）
- 协同效应未正确分阶段引入
- 购买价格分配不平衡
- 未包括放弃的现金利息
- 交易费用未纳入资金来源与用途

**三表：**
- 营运资本变化符号约定错误
- 折旧与PP&E明细表不匹配
- 债务到期计划与本金支付不匹配
- 股息支付超过净利润无法解释

### 第六步：报告

生成模型审计报告：

**摘要：**
- 模型类型和总体评估（干净/小问题/大问题）
- 按严重程度发现的问题数量

**问题日志：**

| # | 标签页 | 单元格/范围 | 严重程度 | 类别 | 描述 | 建议修复 |
|---|-------|-----------|----------|------|------|----------|
| 1 | | | 关键/警告/信息 | 公式/逻辑/平衡/硬编码 | | |

**严重程度定义：**
- **关键**：模型产生错误输出（BS不平衡、公式损坏）
- **警告**：模型可以工作但有风险（硬编码、公式不一致、边缘情况失败）
- **信息**：样式和最佳实践建议（颜色编码、布局、命名）

### 第七步：输出

- 问题日志表（在聊天或Excel中）
- 带注释的模型，对标记的单元格进行注释（如用户提供文件）
- 包含修复优先级的摘要评估

## 重要说明

- 始终首先检查BS平衡——如果不平衡，在解决之前其他都不重要
- 硬编码覆盖是模型错误的#1来源——积极搜索它们
- 符号约定错误（现金流出为正vs负）非常常见
- "可以工作"的模型仍然可能是错的——对输出进行行业基准合理性检查
- 如果模型使用VBA宏，注意任何无法从公式单独审计的宏驱动计算
- 不要在未经询问的情况下更改模型——报告问题并让用户决定如何修复